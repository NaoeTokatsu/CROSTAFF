<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>QRコードテスト</title>
  <script src="https://unpkg.com/html5-qrcode@2.3.9" type="text/javascript"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: black;
      color: white;
      font-family: sans-serif;
    }
    #reader {
      width: 100%;
      max-width: 500px;
      margin: 50px auto;
      border: 2px solid white;
    }
    #status {
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <div id="reader"></div>
  <div id="status">カメラ初期化中...</div>

  <script>
    const statusEl = document.getElementById("status");
    const html5QrCode = new Html5Qrcode("reader");

    Html5Qrcode.getCameras().then(devices => {
      if (devices && devices.length > 0) {
        const cameraId = devices[0].id;

        html5QrCode.start(
          cameraId,
          {
            fps: 10,
            qrbox: { width: 250, height: 250 }
          },
          (decodedText) => {
            console.log("読み取り成功:", decodedText);
            statusEl.innerText = "読み取り成功: " + decodedText;
          },
          (errorMessage) => {
            console.warn("読み取りエラー:", errorMessage);
          }
        ).then(() => {
          statusEl.innerText = "カメラ起動成功・読み取り中";
        }).catch(err => {
          console.error("開始エラー:", err);
          statusEl.innerText = "カメラ開始エラー: " + err;
        });
      } else {
        statusEl.innerText = "利用可能なカメラが見つかりません";
      }
    }).catch(err => {
      console.error("カメラ取得エラー:", err);
      statusEl.innerText = "カメラ取得エラー: " + err;
    });
  </script>

</body>
</html>
